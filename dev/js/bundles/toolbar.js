window.jQuery&&define("jquery",[],function(){"use strict";return window.jQuery}),define(["jquery","mockup-iframe","mockup-registry","mockup-patterns-toggle","mockup-patterns-modal","mockup-patterns-tinymce","mockup-bundles-widgets"],function(a,b,c){"use strict";return a(document).ready(function(){a(".toolbar-dropdown > a").each(function(){a(this).patternToggle({target:".toolbar-dropdown",value:"toolbar-dropdown-open",menu:"parent"})}),a(".toolbar-dropdown .toolbar-dropdown-menu a").click(function(){a(this).parents(".toolbar-dropdown").children("a").trigger("click")}),a(document).on("add-attr.toggle.patterns",".toolbar-dropdown > a",function(){var c=a(this);a(".toolbar-dropdown-open > a").each(function(){c[0]!==a(this)[0]&&a(this).trigger("click")}),b.stretch()}).on("removed-attr.toggle.patterns",".toolbar-dropdown > a",function(){b.shrink()}),b.$el.on("shrink.iframe",function(){a(".toolbar-dropdown-open > a").each(function(){a(this).trigger("click")})}),a(document).on("before-ajax.modal.patterns","a.modal-trigger, a.pat-modal",function(){var c=a(this);a(".toolbar-dropdown-open > a").each(function(){c[0]!==a(this)[0]&&a(this).trigger("click")}),a("body",b.document).css("overflow","hidden"),b.stretch()}).on("show.modal.patterns","a.modal-trigger, a.pat-modal",function(){var c=a(this);a(".toolbar-dropdown-open > a").each(function(){c[0]!==a(this)[0]&&a(this).trigger("click")}),a("body",b.document).css("overflow","hidden"),b.stretch()}).on("hidden.modal.patterns","a.modal-trigger, a.pat-modal",function(){a("body",b.document).css("overflow","visible"),b.shrink()}),a("#plone-action-folderContents > a").addClass("modal-trigger").patternModal({width:"60%",templateOptions:{buttons:"#folderlisting-main-table > input.context,#folderlisting-main-table > input.standalone,.formControls > input",actionsOptions:{onSuccess:function(b,c,d,e,f){var g=f&&f.attr,h=g?f.attr("action"):null;if(h&&-1!==h.indexOf("content_status_history")){var i=a('<a href="'+h.replace("content_status_history","folder_contents")+'"/>');b.options.handleLinkAction.apply(b,[i,{}])}else{if(g){var j=f.attr("action");c=c.replace('action="folder_rename_form','action="'+j+"/folder_rename_form")}b.redraw(c)}}}}}).on("before-render.modal.patterns",function(b,c){a("#plone-document-byline",c.$raw).hide(),a(".modal-footer input.context",c.$raw).removeClass("context").addClass("standalone"),a(".listingBar",c.$raw).each(function(){var b,c,d=a(this),e=a("<ul/>");a("> *",d).each(function(){a(this).hasClass("previous")?b=a("<li/>").append(a("a",this).clone()):a(this).hasClass("next")?c=a("<li/>").append(a("a",this).clone()):a.nodeName(this,"span")?0!==a("a",this).size()?(e.append(a("<li/>").append(a("a",this).clone())),-1!==a(this).html().indexOf("...")&&e.append(a('<li class="deactive"><span>...</span></li>'))):e.append(a('<li class="active"/>').append(a(this).clone())):e.append(a("<li/>").append(a(this).clone()))}),b&&e.prepend(b),c&&e.append(c),d.hide().before(a('<div class="pagination pagination-centered"/>').append(e))})}).on("after-render.modal.patterns",function(b,c){c.$modal.find('input[type="submit"]').addClass("standalone").removeClass("context"),a('.modal-body #folderlisting-main-table td:not(.draggable) > a:not([href$="folder_contents"])',c.$modal).css({color:"#333333"}).off("click").on("click",function(b){b.preventDefault(),b.stopPropagation(),window.parent.location.href=a(this).attr("href")})}),a("#plone-sitesetup a").addClass("modal-trigger").patternModal({width:"80%",templateOptions:{loadLinksWithinModal:!1,actionsOptions:{displayInModal:!1}}}).on("show.modal.patterns",function(b,c){a("a[href]",c.$modal).each(function(){var b=this.href,c=b.split("/");c.splice(c.length-1,0,"++nodiazo++"),b=c.join("/"),a(this).attr("href",b),a(this).click(function(){window.open(b)})})});var c={templateOptions:{buttons:'.formControls > input[type="submit"],.actionButtons input[type="submit"]',automaticallyAddButtonActions:!1}};a("#toolbar-manage-portlets a,#manage-dashboard a").addClass("pat-modal").attr("data-pat-modal",JSON.stringify(c)).on("render.modal.patterns",function(b,c){a(".section select",c.$raw).removeAttr("onchange"),c.options.templateOptions.actions={".section select":{eventType:"change",onSuccess:function(a){0===a.$modal.find(".pat-modal-buttons input").length&&a.reloadWindow()},ajaxUrl:function(a){var b=a.val(),c=a.parents("form").attr("action");return c+b}},".actionButtons input":{error:".fieldErrorBox",onSuccess:function(a){a.reloadWindow()}},".portlet-action":{isForm:!0}}}).on("hidden.modal.patterns",function(a,b){b.reloadWindow()}),a("#plone-contentmenu-factories ul li").addClass("is-content"),a("#plone-contentmenu-factories ul li#plone-contentmenu-more").removeClass("is-content"),a("#plone-contentmenu-factories ul li#plone-contentmenu-settings").removeClass("is-content");var d={width:"80%",templateOptions:{content:"#content",automaticallyAddButtonActions:!1,actionsOptions:{displayInModal:!1},actions:{'input#form-buttons-save, .formControls input[name="form.button.save"]':{},'input#form-buttons-cancel, .formControls input[name="form.button.cancel"]':{modalFunction:"hide"}}}},e=d;e.templateOptions.actionsOptions.redirectToResponseUrl=!0,a("#plone-action-edit > a, #plone-contentmenu-factories ul li.is-content a").addClass("pat-modal").attr("data-pat-modal",JSON.stringify(d)),a("#plone-contentmenu-factories ul li.is-content a").addClass("pat-modal").attr("data-pat-modal",JSON.stringify(e));var f={width:"80%",templateOptions:{content:"#content-core",loadLinksWithinModal:!1}};a("#plone-action-contentrules > a").addClass("pat-modal").attr("data-pat-modal",JSON.stringify(f)).on("render.modal.patterns",function(a,b){b.options.templateOptions.actions={"table.listing a":{ajaxUrl:function(a){return a.attr("href").replace(/@@/g,"++nodiazo++/@@")},displayInModal:!1},'input[name="form.button.AddAssignment"]':{}}}),a("#plone-action-local_roles > a").addClass("modal-trigger").patternModal({width:"80%",templateOptions:{actions:{"#sharing-search-button":function(){},a:function(){}},buttons:'#sharing-save-button, input[name="form.button.Cancel"]'}}).on("render.modal.patterns",function(a,b){b.options.templateOptions.actions[".modal-footer #sharing-save-button"]={onSucess:function(a,b){a.redraw(b),a.$el.on("hidden.modal.patterns",function(){window.parent.location=a.options.ajaxUrl.split("/").slice(0,-1).join("/")})}}})}),{scan:function(b){c.scan(a(b))}}});