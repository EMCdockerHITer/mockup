define(["jquery","mockup-patterns-base"],function(a,b){"use strict";var c=b.extend({name:"autotoc",defaults:{section:"section",levels:"h1,h2,h3",IDPrefix:"autotoc-item-",classTOCName:"autotoc-nav",classSectionName:"autotoc-section",classLevelPrefixName:"autotoc-level-",classActiveName:"active",scrollDuration:"slow",scrollEasing:"swing"},init:function(){var b=this;b.$toc=a("<nav/>").addClass(b.options.classTOCName),b.options.prependTo?b.$toc.prependTo(b.options.prependTo):b.options.appendTo?b.$toc.appendTo(b.options.appendTo):b.$toc.prependTo(b.$el),b.options.className&&b.$el.addClass(b.options.className),a(b.options.section,b.$el).addClass(b.options.classSectionName),a(b.options.levels,b.$el).each(function(c){var d=a(this),e=d.prop("id")?"#"+d.prop("id"):d.parents(b.options.section).prop("id");e||(e=b.options.IDPrefix+b.name+"-"+c,d.prop("id",e)),a("<a/>").appendTo(b.$toc).text(d.text()).prop("href",e).addClass(b.options.classLevelPrefixName+b.getLevel(d)).on("click",function(c,e){c.stopPropagation(),c.preventDefault(),b.$toc.children("."+b.options.classActiveName).removeClass(b.options.classActiveName),b.$el.children("."+b.options.classActiveName).removeClass(b.options.classActiveName),a(c.target).addClass(b.options.classActiveName),d.parents(b.options.section).addClass(b.options.classActiveName),e!==!1&&b.options.scrollDuration&&d&&a("body,html").animate({scrollTop:d.offset().top},b.options.scrollDuration,b.options.scrollEasing),0!==b.$el.parents(".modal").size()&&b.$el.trigger("resize.modal.patterns"),a(this).trigger("clicked")})}),b.$toc.find("a").first().trigger("click",!1)},getLevel:function(b){var c=0;return a.each(this.options.levels.split(","),function(a,d){return 1===b.filter(d).size()?(c=a+1,!1):void 0}),c}});return c});