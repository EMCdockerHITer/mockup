define(["jquery","mockup-registry"],function(a,b){"use strict";function c(a,b,d){if(1===b.length)return a[b[0]]=d,d;var e=b.shift();return a[e]||(a[e]={}),c(a[e],b,d)}function d(b,e,f){f=f||{},0===b.length||a.nodeName(b[0],"body")||(f=d(b.parent(),e,f));var g={};if(0!==b.length&&(g=b.data("pat-"+e),g&&"string"==typeof g)){var h={};a.each(g.split(";"),function(a,b){if(b=b.split(":"),b.length>=1){b.reverse();var c=b.pop();c=c.replace(/^\s+|\s+$/g,""),b.reverse();var d=b.join(":");d=d.replace(/^\s+|\s+$/g,""),h[c]=d}}),g={},a.each(h,function(a,b){c(g,a.split("-"),b)})}return a.extend(!0,{},f,g)}var e=function(b,c){this.$el=b,this.options=this.parser?a.extend(!0,{},this.parser.parse(b,this.defaults||{},this.multipleOptions||!1),c||{}):a.extend(!0,{},this.defaults||{},d(b,this.name),c||{}),this.init(),this.trigger("init")};return e.prototype={constructor:e,on:function(a,b){this.$el.on(a+"."+this.name+".patterns",b)},trigger:function(a,b){void 0===b&&(b=[]);try{b.splice(0,0,this)}catch(c){b=[this]}this.$el.trigger(a+"."+this.name+".patterns",b)}},e.extend=function(c){var d,e=this;d=c&&c.hasOwnProperty("constructor")?c.constructor:function(){e.apply(this,arguments)};var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,d.extend=e.extend,a.extend(!0,d.prototype,c),d.__super__=e.prototype,void 0===d.prototype.jqueryPlugin&&(d.prototype.jqueryPlugin="pattern"+d.prototype.name.charAt(0).toUpperCase()+d.prototype.name.slice(1)),d.prototype.jqueryPlugin&&(a.fn[d.prototype.jqueryPlugin]=function(b,c){return a(this).each(function(){var e=a(this),f=e.data("pattern-"+d.prototype.name);"object"==typeof b&&(c=b,b=void 0),f&&"string"!=typeof f?b&&f&&f[b]&&f[b].apply(f,[c]):(f=new d(e,c),e.data("pattern-"+d.prototype.name,f))}),this}),b.register({name:d.prototype.name,trigger:".pat-"+d.prototype.name,jquery_plugin:!1,init:function(b){return b.each(function(b){var c=a(this),e=c.data("pattern-"+d.prototype.name+"-"+b);e||c.data("pattern-"+d.prototype.name+"-"+b,new d(c))})}}),d},e});