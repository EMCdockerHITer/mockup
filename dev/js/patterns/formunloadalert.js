define(["jquery","mockup-patterns-base"],function(a,b){"use strict";var c=b.extend({name:"formunloadalert",_changed:!1,_suppressed:!1,defaults:{message:"Discard changes? If you click OK, any changes you have made will be lost.",changingEvents:"change keyup paste",changingFields:"input,select,textarea,fileupload"},init:function(){var b=this;if(b.$el.is("form")){a(b.options.changingFields,b.$el).on(b.options.changingEvents,function(){b._changed=!0});var c=b.$el.parents(".modal");0!==c.size()?c.data("pattern-modal").on("hide",function(a,c){c._suppressHide=b._handle_unload.apply(b,a)}):a(window).on("beforeunload",function(a){return b._handle_unload(a)}),b.$el.on("submit",function(){b._suppressed=!0})}},_handle_unload:function(b){var c=this;if(c._suppressed)return c._suppressed=!1,void 0;if(c._changed){var d=c.options.message;return c._handle_msg(b,d),a(window).trigger("messageset"),d}},_handle_msg:function(a,b){(a||window.event).returnValue=b}});return c});